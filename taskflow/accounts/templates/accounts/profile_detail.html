{% extends "base.html" %}
{% block title %} {{title }} | {{block.super }}{% endblock %}


{% block content %}

 <div class="container-fluid">
        <div class="row">
          <div class="col-md-3">

            <!-- Profile Image -->
            <div class="card card-primary card-outline">
              <div class="card-body box-profile">
                <div class="text-center">
                  <img class="profile-user-img img-fluid img-circle"
                       src="{{ profile.profile_picture_url }}"
                       alt="User profile picture">
                </div>

                <h3 class="profile-username text-center">{{ profile.full_name }}</h3>

                <p class="text-muted text-center">{{ profile.job_title}}</p>

                <ul class="list-group list-group-unbordered mb-3">
                  <li class="list-group-item">
                    <b>Projects</b> <a class="float-right">{{ user_projects_count }}</a>
                  </li>
                  <li class="list-group-item">
                    <b>Tasks</b> <a class="float-right">{{ user_tasks_count }}</a>
                  </li>
                </ul>               
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->

            <!-- About Me Box -->
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">About Me</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <strong><i class="fas fa-book mr-1"></i> Education</strong>

                <p class="text-muted">
                  {{ profile.education_level}}
                </p>

                <hr>

                <strong><i class="fas fa-map-marker-alt mr-1"></i> Location</strong>

                <p class="text-muted">{{ profile.location }}</p>

                <hr>

                <strong><i class="fas fa-pencil-alt mr-1"></i> Skills</strong>

                <p class="text-muted">
                  {{ profile.skills }}
                </p>

                <hr>

                <strong><i class="far fa-file-alt mr-1"></i> Biography</strong>

                <p class="text-muted">{{ profile.bio }}</p>
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
          <div class="col-md-9">
            <div class="card">
              <div class="card-header p-2">
                <ul class="nav nav-pills">
                  <li class="nav-item"><a class="nav-link active" href="#activity" data-toggle="tab">Projects</a></li>
                  <li class="nav-item"><a class="nav-link" href="#timeline" data-toggle="tab">Tasks</a></li>
                  
                </ul>
              </div><!-- /.card-header -->
              <div class="card-body">
                <div class="tab-content">
                  <div class="active tab-pane" id="activity">

                     <div class="card-body p-0">
          <table class="table table-striped projects">
              <thead>
                  <tr>
                      <th style="width: 1%">
                          #
                      </th>
                      <th style="width: 20%">
                          Project Name
                      </th>
                      <th style="width: 30%">
                          Team Members
                      </th>
                      <th>
                          Project Progress
                      </th>
                      <th style="width: 8%" class="text-center">
                          Priority
                      </th>
                      <th style="width: 20%">
                      </th>
                  </tr>
              </thead>
              <tbody>

                {% for project in page_obj %}
                  <tr>
                      <td>
                         {{ forloop.counter }}
                      </td>
                      <td>
                          <a href="{% url "projects:project-detail" project.id %}">
                              {{ project.name }}
                          </a>
                          <br/>
                          <small>
                              Created {{ project.start_date }}
                          </small>
                      </td>
                      <td>
                          <ul class="list-inline">
                            {% for member in project.team.members.all %}
                              <li class="list-inline-item">
                                  <img alt="Avatar" class="table-avatar" src="{{ member.profile.profile_picture_url }}">
                              </li>
                              {% endfor %}
                              
                          </ul>
                      </td>
                      <td class="project_progress">
                          <div class="progress progress-sm">
                              <div class="progress-bar bg-{{project.status_color}}" role="progressbar" aria-valuenow="{{ project.progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{project.progress}}%">
                              </div>
                          </div>
                          <small>
                            {{ project.progress}}% Complete
                          </small>
                      </td>
                      <td class="project-state">
                          <span class="badge badge-{{ project.priority_color }}">{{ project.priority }}</span>
                      </td>
                      <td class="project-actions text-right">
                         
                        {% if request.user == project.owner %}
                          <a href="{% url "projects:update" project.pk %}" class="btn btn-info btn-sm" href="#">
                              <i class="fas fa-pencil-alt">
                              </i>
                              Edit
                          </a>

                          
                           <a href="{% url "projects:delete" project.pk %}" class="btn btn-danger btn-sm" href="#">
                              <i class="fas fa-trash">
                              </i>
                              Delete
                          </a>
                          {% endif %}
                         
                      </td>
                  </tr>

                  {% endfor %}



              </tbody>
          </table>

       {% include "components/paginator.html" %}


        {% comment %} displaying messages {% endcomment %}
            {% if messages %}
            <div class="messages col-10">
              {% for message in messages %}
              <div class="alert {% if message.tags %}alert-{{message.tags}}{% else %}alert-info{% endif %}">
                {{ message }}
              </div>
              
              {% endfor %}

            </div>
            
            {% endif %}

       


        </div>
        <!-- /.card-body -->
                  
                    <!-- /.post -->
                  </div>


                  <!-- /.tab-pane -->
                  <div class="tab-pane" id="timeline">

                      <div class="card-body p-0">
          <table class="table table-striped projects">
              <thead>
                  <tr>
                      <th style="width: 1%">
                          #
                      </th>
                      <th style="width: 20%">
                          Task Name
                      </th>
                      <th style="width: 30%">
                          Team Members
                      </th>
                      <th>
                          Task Progress
                      </th>
                      <th style="width: 8%" class="text-center">
                          Priority
                      </th>
                      <th style="width: 20%">
                      </th>
                  </tr>
              </thead>
              <tbody>

                {% for task in tasks %}
                  <tr>
                      <td>
                         {{ forloop.counter }}
                      </td>
                      <td>
                          <a href="">
                              {{ task.name }}
                          </a>
                          <br/>
                          <small>
                              Created {{ task.created_at }}
                          </small>
                      </td>
                      <td>
                          <ul class="list-inline">
                            {% for member in task.project.team.members.all %}
                              <li class="list-inline-item">
                                  <img alt="Avatar" class="table-avatar" src="{{ member.profile.profile_picture_url }}">
                              </li>
                              {% endfor %}
                              
                          </ul>
                      </td>
                      <td class="project_progress">
                          <div class="progress progress-sm">
                              <div class="progress-bar bg-{{task.status_color}}" role="progressbar" aria-valuenow="{{ task.progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{task.progress}}%">
                              </div>
                          </div>
                          <small>
                            {{ task.progress}}% Complete
                          </small>
                      </td>
                      <td class="project-state">
                          <span class="badge badge-{{ task.priority_color }}">{{ task.priority }}</span>
                      </td>
                    
                  </tr>

                  {% endfor %}



              </tbody>
          </table>

       {% include "components/paginator.html" with page_obj=tasks query_name="task_page" %}


       


        </div>

                    
                  </div>
                  <!-- /.tab-pane -->

                 
                </div>
                <!-- /.tab-content -->
                 <hr>
                 <br>
                 <h2 class="card-title">Comments {{ all_user_comments_count }}</h2>
                  <br>
                   <br>

                 <!-- comments start here -->
                  {% for comment in  comments %}
                    <!-- Comment -->
                    <div class="post">
                      <div class="user-block">
                        <img class="img-circle img-bordered-sm" src="{{ comment.user.profile.profile_picture_url}}" alt="user image">
                        <span class="username">
                          <a href="#">{{ comment.user.profile.full_name }}</a>
                          <a href="#" class="float-right btn-tool"><i class="fas fa-times"></i></a>
                        </span>
                        <span class="description">Shared publicly - {{ comment.created_at | timesince }}</span>
                      </div>
                      <!-- /.user-block -->
                      <p>
                       {{ comment.comment }}
                      </p>

                    </div>
                    <!-- /.post -->
                     {% endfor %}

                      {% include "components/paginator.html" with page_obj=comments query_name="comment_page" %}



              </div><!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div><!-- /.container-fluid -->

{% endblock %}